<?xml version="1.0"?>
<!-- Copyright 2025 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<component>
  <!-- Heatbed Temperature Sub-Screen -->
  <!-- Temperature control with presets and custom input -->
  <!-- Component-local constants for theme-aware colors -->
  <consts>
    <!-- Bed temperature graph series color (cyan) -->
    <const name="temp_graph_bed_light" value="#00CED1"/>
    <const name="temp_graph_bed_dark" value="#33E5E8"/>
  </consts>
  <!-- Uses shared backdrop from navigation system -->
  <view extends="lv_obj" name="bed_temp_panel" width="#overlay_panel_width_large" height="100%" align="right_mid" style_bg_opa="255" style_bg_color="#card_bg" style_border_width="0" style_pad_all="0" scrollable="false" flex_flow="column">
    <!-- Header Bar (uses improved header_bar component) -->
    <header_bar name="overlay_header" title="Heatbed Temperature" action_button_text="Confirm" hide_action_button="false"/>
    <!-- Content Area: Two Columns -->
    <lv_obj name="overlay_content" flex_grow="1" width="100%" style_bg_opa="0" style_pad_all="#space_lg" scrollable="false" style_border_width="0" style_border_opa="0" flex_flow="row" style_flex_main_place="space_between">
      <!-- Left Column (66%): Temperature Graph with Y-axis labels + X-axis time labels -->
      <lv_obj name="graph_outer_container" width="66%" height="100%" style_bg_opa="0" style_pad_all="0" scrollable="false" style_border_width="0" style_border_opa="0" flex_flow="column" style_pad_gap="0">
        <!-- Graph area (Y-axis + chart) -->
        <lv_obj name="graph_container" width="100%" flex_grow="1" style_bg_opa="0" style_pad_all="0" scrollable="false" style_border_width="0" style_border_opa="0" flex_flow="row" style_flex_main_place="start" style_flex_cross_place="start" style_pad_gap="#space_sm">
          <!-- Y-axis labels (created programmatically in C++) -->
          <lv_obj name="y_axis_labels" width="40" height="100%" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false" flex_flow="column" style_flex_main_place="space_between" style_flex_cross_place="end">
          </lv_obj>
          <!-- Chart area -->
          <lv_obj name="chart_area" flex_grow="1" height="100%" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
            <!-- Temperature graph widget created programmatically in C++ -->
          </lv_obj>
        </lv_obj>
        <!-- X-axis time labels (hidden until 60+ data points via reactive binding) -->
        <lv_obj name="x_axis_labels" width="100%" height="20" style_bg_opa="0" style_border_width="0" style_pad_all="0" style_pad_left="48" style_pad_right="8" scrollable="false" flex_flow="row" style_flex_main_place="space_between">
          <text_small name="x_label_0" text="">
            <lv_obj-bind_flag_if_lt subject="bed_graph_points" flag="hidden" ref_value="60"/>
          </text_small>
          <text_small name="x_label_1" text="">
            <lv_obj-bind_flag_if_lt subject="bed_graph_points" flag="hidden" ref_value="60"/>
          </text_small>
          <text_small name="x_label_2" text="">
            <lv_obj-bind_flag_if_lt subject="bed_graph_points" flag="hidden" ref_value="60"/>
          </text_small>
          <text_small name="x_label_3" text="">
            <lv_obj-bind_flag_if_lt subject="bed_graph_points" flag="hidden" ref_value="60"/>
          </text_small>
          <text_small name="x_label_4" text="">
            <lv_obj-bind_flag_if_lt subject="bed_graph_points" flag="hidden" ref_value="60"/>
          </text_small>
          <text_small name="x_label_5" text="">
            <lv_obj-bind_flag_if_lt subject="bed_graph_points" flag="hidden" ref_value="60"/>
          </text_small>
        </lv_obj>
      </lv_obj>
      <!-- Right Column (33%): Controls - use space_between for temp card at top, buttons at bottom -->
      <lv_obj name="right_column" width="33%" height="100%" style_bg_opa="0" style_pad_all="0" scrollable="false" style_border_width="0" flex_flow="column" style_flex_main_place="space_between" style_flex_cross_place="center">
        <!-- Current/Target Temperature Display Card with Icon and Status -->
        <ui_card name="temp_display_card" width="100%" style_radius="0" flex_flow="column" style_flex_main_place="center" style_flex_cross_place="center" style_pad_gap="#space_sm">
          <!-- Icon + Temp Row -->
          <lv_obj style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false" flex_flow="row" style_flex_main_place="center" style_flex_cross_place="center" style_pad_gap="#space_md">
            <!-- Composite heatbed icon: two overlapping sets with conditional visibility -->
            <!-- Secondary (off) icons: hidden when heating (bed_heating == 1) -->
            <lv_obj name="bed_icon_off" width="content" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false" flex_flow="column" style_flex_cross_place="center" style_pad_row="-12">
              <lv_obj-bind_flag_if_eq subject="bed_heating" flag="hidden" ref_value="1"/>
              <icon name="heat_wave_icon_off" src="heat_wave" size="md" variant="secondary"/>
              <icon name="flatbed_icon_off" src="train_flatbed" size="md" variant="secondary"/>
            </lv_obj>
            <!-- Accent (on) icons: hidden when not heating (bed_heating == 0) -->
            <lv_obj name="bed_icon_on" width="content" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false" flex_flow="column" style_flex_cross_place="center" style_pad_row="-12" style_margin_left="-32">
              <lv_obj-bind_flag_if_eq subject="bed_heating" flag="hidden" ref_value="0"/>
              <icon name="heat_wave_icon_on" src="heat_wave" size="md" variant="accent"/>
              <icon name="flatbed_icon_on" src="train_flatbed" size="md" variant="accent"/>
            </lv_obj>
            <lv_obj style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false" flex_flow="column" style_flex_main_place="center" style_flex_cross_place="center" style_pad_gap="#space_xxs">
              <text_small text="Current / Target" align="center"/>
              <lv_label name="bed_temp_display" bind_text="bed_temp_display" style_text_font="montserrat_28" align="center"/>
            </lv_obj>
          </lv_obj>
          <!-- Status Message inside the card -->
          <text_small name="status_message" bind_text="bed_status" width="100%" style_text_align="center" scrollable="false"/>
        </ui_card>
        <!-- Buttons container: groups preset grid + custom button together -->
        <lv_obj name="buttons_container" width="100%" height="content" style_bg_opa="0" style_pad_all="0" style_border_width="0" scrollable="false" flex_flow="column" style_pad_gap="#space_sm">
          <!-- Preset Buttons (2x2 grid using flex wrap with 48% width per button) -->
          <lv_obj name="preset_grid" width="100%" style_bg_opa="0" style_pad_all="0" style_border_width="0" scrollable="false" flex_flow="row_wrap" style_flex_main_place="space_between" style_flex_cross_place="center" style_pad_gap="#space_sm">
            <lv_button name="preset_off" width="48%" height="#button_height_small" style_radius="#border_radius_small" style_border_width="0">
              <text_small text="Off (0&#xB0;C)" align="center"/>
            </lv_button>
            <lv_button name="preset_pla" width="48%" height="#button_height_small" style_radius="#border_radius_small" style_border_width="0">
              <text_small text="PLA (60&#xB0;C)" align="center"/>
            </lv_button>
            <lv_button name="preset_petg" width="48%" height="#button_height_small" style_radius="#border_radius_small" style_border_width="0">
              <text_small text="PETG (80&#xB0;C)" align="center"/>
            </lv_button>
            <lv_button name="preset_abs" width="48%" height="#button_height_small" style_radius="#border_radius_small" style_border_width="0">
              <text_small text="ABS (100&#xB0;C)" align="center"/>
            </lv_button>
          </lv_obj>
          <!-- Custom Button -->
          <lv_button name="btn_custom" width="100%" height="#button_height_small" style_radius="#border_radius_small" style_border_width="0">
            <text_body text="Custom..." align="center"/>
          </lv_button>
        </lv_obj>
      </lv_obj>
    </lv_obj>
  </view>
</component>
